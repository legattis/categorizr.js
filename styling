#styling sheets



3b) Filter array – mapRow
From: body(‘Get_items_-EIL_Directory’)?[‘value’]
Condition (advanced):
@equals(toLower(string(item()?[‘EIL’])), toLower(outputs(’Compose-_itemEIL’)))

3c) Condition – mapping found?
Left (expression): length(body(‘Filter_array_-_mapRow’))
Operator: is greater than
Right: 0

If YES:

3d) Get user profile (V2)
User (UPN): first(body(‘Filter_array_-_mapRow’))?[‘IMS_Email’]

3e) Update item – ROS
Id: items(‘Apply_to_each_-missingIMS’)?[‘ID’]
IMS_x002d_EIL (Person) → click the field, choose “Enter custom value”, and paste this object:
{ “Claims”: concat(‘i:0#.f|membership|’, body(’Get_user_profile(V2)’)?[‘mail’]), “DisplayName”: body(‘Get_user_profile_(V2)’)?[‘displayName’], “Email”: body(‘Get_user_profile_(V2)’)?[‘mail’] }
(If your tenant prefers userPrincipalName: replace mail with userPrincipalName in all three spots.)

If NO: do nothing (or log the EIL so you can add it to the directory).

————————————————————————

NO DIRECTORY LIST? (inline map quick start)
Drop this before the loop and change the Filter array in 3b to use it.

Compose – eilMap
[ {“EIL”:“212”,“IMS_Email”:“someone@va.gov”}, {“EIL”:“471J”,“IMS_Email”:“someoneelse@va.gov”} ]

Then 3b From = outputs(‘Compose_-_eilMap’) and keep the same advanced condition.

————————————————————————

Why this fits your types
• We filter for missing person values with “IMS_x002d_EIL eq null” (person).
• We exclude completed with “CurrentStatus ne ‘Completed’” (text).
• We match EIL as text, case-insensitive.
• We set the Person field with a Claims/DisplayName/Email object so it resolves correctly.

Want me to add a tiny “If Get user profile fails → skip and capture EIL + email to a log list” branch so you can see any bad directory rows?
